<div class="w-full bg-card dark:bg-transparent" *ngIf="(allDwrsList$ | async) as employee">
    <div class="sm:p-0 rounded-md" *ngIf="employee?.dwrTasks">
        <div class="border-b">
            <div class="relative flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between py-4 px-6 md:px-8">
                <!-- Loader -->
                <div class="absolute inset-x-0 bottom-0" *ngIf="isLoadingEmployee$ | async">
                    <mat-progress-bar [mode]="'indeterminate'"></mat-progress-bar>
                </div>
                <!-- Title -->
                <div class="text-2xl font-extrabold tracking-tight">All DWRs</div>
                <!-- Actions -->
                <div class="flex sm:flex-row flex-col flex-shrink-0 items-center mt-1 sm:mt-0 sm:ml-4 ">
                    <div class="flex">
                        <!--Filter-->
                        <button mat-flat-button class="mat-filter" (click)="filtersDrawer.toggle()">
                            <mat-icon
                                *ngIf="dwrFiltersForm.value.beginning_date || dwrFiltersForm.value.ending_date || dwrFiltersForm.value.name || dwrFiltersForm.value.category || dwrFiltersForm.value.supervisor_name || dwrFiltersForm.value.state"
                                [svgIcon]="'heroicons_solid:filter'"></mat-icon>
                            <mat-icon
                                *ngIf="!dwrFiltersForm.value.beginning_date && !dwrFiltersForm.value.ending_date && !dwrFiltersForm.value.name && !dwrFiltersForm.value.category && !dwrFiltersForm.value.supervisor_name && !dwrFiltersForm.value.state"
                                [svgIcon]="'heroicons_outline:filter'"></mat-icon>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Main -->
        <div class="flex flex-auto overflow-hidden">
            <div class="flex flex-col flex-auto overflow-hidden sm:overflow-y-auto">
                <ng-container>
                    <ng-container>
                        <div class="grid">
                            <!-- Header -->
                            <div class="farm-data-farms z-10 sticky top-0 grid gap-4 py-4 px-6 md:px-8 shadow text-md font-semibold text-secondary bg-gray-50 dark:bg-black dark:bg-opacity-5" matSort matSortDisableClear>
                                <div class="sm:block">ID</div>
                                <div class="sm:block">Date</div>
                                <div class="sm:block">Name</div>
                                <div>Supervisor</div>
                                <div>Category</div>
                                <div class="hidden sm:block">State</div>
                                <div class="hidden sm:block">Hours</div>
                                <div class="hidden sm:block">Hourly Rate</div>
                                <div class="hidden sm:block">Total Wages</div>
                                <!-- <div class="">Actions</div> -->
                            </div>
                            <!-- Rows -->
                            <ng-container>
                                <ng-container *ngIf="employee?.dwrTasks.length > 0; else noPayroll">
                                    <div *ngFor="let payroll of employee?.dwrTasks" class="farm-data-farms grid items-center gap-4 py-3 px-6 md:px-8 border-b">
                                        <div
                                        class="sm:block flex items-center cursor-pointer truncate break-words text-blue-600 hover:text-blue-800 visited:text-purple-600"


                                        >{{payroll.id}}</div>

                                        <div class="truncate hidden sm:block">{{payroll.date |  date: "MM-d-YYYY"}}</div>
                                        <div class="truncate">{{payroll.first_name}} {{payroll.last_name}}</div>
                                        <div class="truncate">{{payroll.supervisor}}</div>
                                        <div class="truncate">{{payroll.category}}</div>
                                        <div class="truncate hidden sm:block">{{payroll.state}}</div>
                                        <div class="truncate hidden sm:block">{{payroll.hours_worked}}</div>
                                        <div class="truncate hidden sm:block">${{payroll.state=='Arizona' ? employee?.hourly_rate[0].arizona_rate : employee?.hourly_rate[0].max_hourly_rate}}</div>
                                        <div class="truncate hidden sm:block">${{totalWage(payroll.hours_worked, employee?.hourly_rate[0].arizona_rate, employee?.hourly_rate[0].max_hourly_rate, payroll.state)}}</div>
                                    </div>
                                </ng-container>
                            </ng-container>
                        </div>
                    </ng-container>
                </ng-container>
                <ng-template #noProducts>
                    <div class="p-8 sm:p-16 border-t text-4xl font-semibold tracking-tight text-center">
                        There is no Payroll Data!
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>
<!-- Filters -->
<fuse-drawer class="w-100 min-w-100 sm:w-100 sm:min-w-100 z-999 bg-green-300" fixed [mode]="'over'"
    [name]="'filtersDrawer'" [position]="'right'" #filtersDrawer>
    <div class="flex flex-col w-100 overflow-auto bg-card">
        <div class="flex flex-row items-center px-6 h-20 min-h-20 text-white bg-primary">
            <mat-icon class="icon-size-7 text-current" [svgIcon]="'heroicons_outline:filter'"></mat-icon>
            <div class="ml-3 text-2xl font-semibold tracking-tight">
                Filters
            </div>
            <button class="ml-auto" mat-icon-button mat-icon-button (click)="filtersDrawer.close()">
                <mat-icon class="text-current" [svgIcon]="'heroicons_outline:x'"></mat-icon>
            </button>
        </div>
        <div class="flex flex-col justify-center items-center h-screen">
            <div class="h-5/6 w-96">
                <div class="w-inherit flex flex-col">
                    <form [formGroup]="dwrFiltersForm" (ngSubmit)="applyFilters()"
                        class="flex flex-col flex-auto p-6 sm:p-8">
                        <div class="flex flex-col flex-auto justify-between gap-x-6 p-0">
                            <mat-form-field appearance="outline">
                                <mat-label>Name</mat-label>
                                <input matInput formControlName="name" >
                            </mat-form-field>
                        </div>
                        <mat-form-field appearance="outline" class="cat w-full">
                            <mat-label>Select State</mat-label>
                            <mat-select formControlName="state">
                                <mat-option *ngFor="let state of states" [value]="state">{{ state }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field birthdayFormat class="w-full" appearance="outline">
                            <mat-label>Payroll Period</mat-label>
                            <mat-date-range-input [rangePicker]="picker">
                                <input matStartDate formControlName="beginning_date"
                                    placeholder="Start date">
                                <input matEndDate formControlName="ending_date"
                                    placeholder="End date">
                            </mat-date-range-input>
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-date-range-picker #picker></mat-date-range-picker>
                        </mat-form-field>
                        <mat-form-field appearance="outline">
                            <mat-label>Supervisor</mat-label>
                            <input matInput formControlName="supervisor_name" >
                        </mat-form-field>
                        <mat-form-field appearance="outline">
                            <mat-label>Category</mat-label>
                            <mat-select formControlName="category">
                                <mat-option [value]="'training'">Training</mat-option>
                                <mat-option [value]="'farming'">Farming</mat-option>
                                <mat-option [value]="'maintenance-repair'">Maintenance Repair</mat-option>
                                <mat-option [value]="'other'">Other</mat-option>
                            </mat-select>
                        </mat-form-field>

                    </form>
                </div>
            </div>
            <div class="flex flex-row justify-evenly items-center w-80">
                <div class="w-inherit flex justify-center items-center mt-1 mb-1">
                    <button [disabled]="!dwrFiltersForm.value.beginning_date && !dwrFiltersForm.value.ending_date && !dwrFiltersForm.value.name && !dwrFiltersForm.value.category && !dwrFiltersForm.value.supervisor_name && !dwrFiltersForm.value.state || dwrFiltersForm.invalid"
                    (click)="applyFilters(); filtersDrawer.close()" class="" mat-flat-button
                        [color]="'primary'">
                        <span class="">Apply filters</span>
                    </button>
                </div>
                <div class="w-inherit flex justify-center items-center mt-1 mb-1">
                    <button [disabled]="!dwrFiltersForm.value.beginning_date && !dwrFiltersForm.value.ending_date && !dwrFiltersForm.value.name && !dwrFiltersForm.value.category && !dwrFiltersForm.value.supervisor_name && !dwrFiltersForm.value.state || dwrFiltersForm.invalid"
                    (click)="removeFilters(); filtersDrawer.close()" mat-flat-button [color]="'warn'">
                        <span>Remove filters</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</fuse-drawer>
